<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Offline Test - Tushar Basak Portfolio</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        button {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 5px;
        }
        button:hover {
            background: #ff5252;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
        }
        .online { background: #c8e6c9; color: #2e7d32; }
        .offline { background: #ffcdd2; color: #c62828; }
        .log {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            max-height: 300px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üß™ Offline Functionality Test</h1>
        <p>Use this page to test the offline functionality of the portfolio website.</p>
        
        <div id="status" class="status">
            Connection Status: <span id="connection-status">Checking...</span>
        </div>
        
        <div>
            <button onclick="testConnectivity()">Test Connectivity</button>
            <button onclick="simulateOffline()">Simulate Offline</button>
            <button onclick="goToMainSite()">Go to Main Site</button>
            <button onclick="goToOfflinePage()">Go to Offline Page</button>
            <button onclick="clearLog()">Clear Log</button>
        </div>
        
        <h3>Test Log:</h3>
        <div id="log" class="log"></div>
        
        <h3>Instructions:</h3>
        <ol>
            <li><strong>Test Normal Flow:</strong> Click "Go to Main Site" to visit the portfolio</li>
            <li><strong>Test Offline Detection:</strong> 
                <ul>
                    <li>Open Developer Tools (F12)</li>
                    <li>Go to Network tab</li>
                    <li>Check "Offline" checkbox</li>
                    <li>Try to navigate or refresh the page</li>
                </ul>
            </li>
            <li><strong>Test Recovery:</strong> Uncheck "Offline" and see if it redirects back</li>
            <li><strong>Test Service Worker:</strong> Check Console for service worker logs</li>
        </ol>
        
        <h3>Expected Behavior:</h3>
        <ul>
            <li>‚úÖ When online: Normal website functionality</li>
            <li>‚úÖ When going offline: Notification appears, then redirects to offline page</li>
            <li>‚úÖ When back online: Notification appears, then redirects back to main site</li>
            <li>‚úÖ Service worker: Caches all resources for offline use</li>
        </ul>
    </div>

    <script>
        let logElement = document.getElementById('log');
        let statusElement = document.getElementById('connection-status');
        let statusContainer = document.getElementById('status');

        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            logElement.innerHTML += `[${timestamp}] ${message}<br>`;
            logElement.scrollTop = logElement.scrollHeight;
            console.log(message);
        }

        function updateStatus() {
            const isOnline = navigator.onLine;
            statusElement.textContent = isOnline ? 'Online' : 'Offline';
            statusContainer.className = `status ${isOnline ? 'online' : 'offline'}`;
            log(`Status updated: ${isOnline ? 'Online' : 'Offline'}`);
        }

        function testConnectivity() {
            log('Testing connectivity...');
            fetch('/favicon.ico?' + Date.now(), { 
                method: 'HEAD',
                cache: 'no-cache'
            })
            .then(response => {
                if (response.ok) {
                    log('‚úÖ Connectivity test passed - Server reachable');
                } else {
                    log('‚ùå Connectivity test failed - Server returned error');
                }
            })
            .catch(error => {
                log('‚ùå Connectivity test failed - ' + error.message);
            });
        }

        function simulateOffline() {
            log('‚ö†Ô∏è To simulate offline, use browser DevTools:');
            log('1. Press F12 to open DevTools');
            log('2. Go to Network tab');
            log('3. Check "Offline" checkbox');
            log('4. Try refreshing or navigating');
        }

        function goToMainSite() {
            log('Navigating to main site...');
            window.location.href = '/';
        }

        function goToOfflinePage() {
            log('Navigating to offline page...');
            window.location.href = '/offline.html';
        }

        function clearLog() {
            logElement.innerHTML = '';
            log('Log cleared');
        }

        // Initialize
        updateStatus();
        log('Offline test page loaded');
        log('Navigator.onLine: ' + navigator.onLine);

        // Listen for online/offline events
        window.addEventListener('online', () => {
            updateStatus();
            log('üü¢ Online event detected');
        });

        window.addEventListener('offline', () => {
            updateStatus();
            log('üî¥ Offline event detected');
        });

        // Check service worker status
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.ready.then(registration => {
                log('‚úÖ Service Worker is ready');
                log('Scope: ' + registration.scope);
            });
        } else {
            log('‚ùå Service Worker not supported');
        }
    </script>
</body>
</html>